<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <title>WebGIS Project</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: "Cairo", sans-serif;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
        #darkToggle {
            position: absolute;
            top: 15px;
            left: 15px;
            z-index: 9999;
            background: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0 0 5px #0003;
        }
    </style>
</head>
<body>

<div id="darkToggle">ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</div>
<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>

// ğŸ—ºï¸ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
var map = L.map("map").setView([31.9, 35.2], 11);

// ğŸŸ¦ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ
var lightBasemap = L.tileLayer(
    "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
    { maxZoom: 19 }
).addTo(map);

// ğŸŒ‘ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
var darkBasemap = L.tileLayer(
    "https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",
    { maxZoom: 19 }
);

// ğŸ”€ Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
document.getElementById("darkToggle").onclick = function () {
    if (map.hasLayer(lightBasemap)) {
        map.removeLayer(lightBasemap);
        map.addLayer(darkBasemap);
        this.innerHTML = "â˜€ï¸ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ";
    } else {
        map.removeLayer(darkBasemap);
        map.addLayer(lightBasemap);
        this.innerHTML = "ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ";
    }
};

// â­â­â­ ØªØ­Ù…ÙŠÙ„ Ø·Ø¨Ù‚Ø© Ø±Ø§Ù… Ø§Ù„Ù„Ù‡ (Ø£Ø³Ø§Ø³ Ø§Ù„Ø®Ø±ÙŠØ·Ø©)
var ramallahLayer;

fetch("ramallah.geojson")
    .then(res => res.json())
    .then(data => {
        ramallahLayer = L.geoJSON(data, {
            style: { color: "gray", weight: 1, fillOpacity: 0.1 }
        }).addTo(map);
    });

// -------------------------
// Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…Ø®ØµØµØ© ğŸ« ğŸ’§
// -------------------------

var schoolIcon = L.icon({
    iconUrl: "https://cdn-icons-png.flaticon.com/512/167/167707.png",
    iconSize: [32, 32],
    iconAnchor: [16, 32],
    popupAnchor: [0, -28]
});

var wellIcon = L.icon({
    iconUrl: "https://cdn-icons-png.flaticon.com/512/4148/4148460.png",
    iconSize: [28, 28],
    iconAnchor: [14, 28],
    popupAnchor: [0, -25]
});

// -------------------------
// Ø·Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ ğŸ«
// -------------------------
var schoolsLayer;

fetch("schools.geojson")
    .then(res => res.json())
    .then(data => {

        schoolsLayer = L.geoJSON(data, {
            pointToLayer: function (feature, latlng) {
                return L.marker(latlng, { icon: schoolIcon });
            },
            onEachFeature: function (feature, layer) {
                var arabicName = feature.properties.school_ar || "Ù…Ø¯Ø±Ø³Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©";
                var englishName = feature.properties.school_en || "Unknown school";

                layer.bindPopup(`
                    <b>Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ø¹Ø±Ø¨ÙŠ):</b> ${arabicName}<br>
                    <b>School Name (EN):</b> ${englishName}
                `);
            }
        }).addTo(map);

    });

// -------------------------
// Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¢Ø¨Ø§Ø± ğŸ’§
// -------------------------
var wellsLayer;

fetch("wells.geojson")
    .then(res => res.json())
    .then(data => {

        wellsLayer = L.geoJSON(data, {
            pointToLayer: function (feature, latlng) {
                return L.marker(latlng, { icon: wellIcon });
            },
            onEachFeature: function (feature, layer) {
                layer.bindPopup(`
                    <b>Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø¦Ø±:</b> ${feature.properties.type || "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"}<br>
                    <b>Ø§Ù„Ø¹Ù…Ù‚:</b> ${feature.properties.depth || "ØºÙŠØ± Ù…ØªÙˆÙØ±"} Ù…ØªØ±
                `);
            }
        }).addTo(map);

    });

// -------------------------
// Ø·Ø¨Ù‚Ø© Ø§Ù„Ø·Ø±Ù‚ + Ø§Ù„Ø­Ø¯ÙˆØ¯ + Ø§Ù„Ù…Ø¹Ø§Ù„Ù…
// -------------------------

var layersToLoad = [
    { file: "roads.geojson", color: "orange", name: "Ø§Ù„Ø·Ø±Ù‚" },
    { file: "boundaries.geojson", color: "blue", name: "Ø§Ù„Ø­Ø¯ÙˆØ¯" },
    { file: "landmarks.geojson", color: "green", name: "Ø§Ù„Ù…Ø¹Ø§Ù„Ù…" }
];

layersToLoad.forEach(layerInfo => {
    fetch(layerInfo.file)
        .then(res => res.json())
        .then(data => {
            L.geoJSON(data, {
                style: { color: layerInfo.color, weight: 2 },
                onEachFeature: function (feature, layer) {
                    layer.bindPopup(`
                        <b>${layerInfo.name}</b><br>
                        ${JSON.stringify(feature.properties, null, 2)}
                    `.replace(/\n/g, "<br>"));
                }
            }).addTo(map);
        });
});

</script>

</body>
</html>
