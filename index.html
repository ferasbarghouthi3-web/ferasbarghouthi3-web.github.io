<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Web GIS - Ramallah</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html,body{height:100%;margin:0;}
#map{height:100%;width:100%;}

/* ICONS */
.icon{
  width:20px;
  height:20px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
  font-weight:bold;
  border:2px solid #000;
}
.icon-school{background:#1e90ff;color:#fff;border-radius:4px;}
.icon-hospital{background:#b22222;color:#fff;border-radius:50%;}
.icon-clinic{background:#2e8b57;color:#fff;}

/* POPUP */
.popup-title{font-weight:bold;margin-bottom:6px;}
.popup-table{width:100%;border-collapse:collapse;}
.popup-table td{border-bottom:1px solid #ddd;font-size:12px;padding:3px;}
</style>
</head>

<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* =========================
   MAP
========================= */
var map = L.map("map").setView([31.9038,35.2034],11);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{
  attribution:"&copy; OpenStreetMap"
}).addTo(map);

/* =========================
   POPUP FUNCTION
========================= */
function popupAttributes(feature, layer, title){
  if(!feature.properties) return;
  let html = `<div class="popup-title">${title}</div><table class="popup-table">`;
  for(let k in feature.properties){
    html += `<tr><td><b>${k}</b></td><td>${feature.properties[k]}</td></tr>`;
  }
  html += "</table>";
  layer.bindPopup(html);
}

/* =========================
   LOAD DATA
========================= */
Promise.all([
  fetch("ramallah.json").then(r=>r.json()),
  fetch("area_A.geojson").then(r=>r.json()),
  fetch("Area_B.geojson").then(r=>r.json()),
  fetch("area_C.geojson").then(r=>r.json())
]).then(initLayers);

/* =========================
   LAYERS
========================= */
function initLayers(data){

let [ramallah, areaA, areaB, areaC] = data;

/* Ramallah Boundary */
var ramallahLayer = L.geoJSON(ramallah,{
  style:{color:"#000",weight:4,fillOpacity:0}
}).addTo(map);

/* ===== AREA A ===== */
var areaALayer = L.geoJSON(areaA,{
  style:{
    color:"#006400",
    weight:1,
    fillColor:"#00ff00",
    fillOpacity:0.35
  },
  onEachFeature:(f,l)=>popupAttributes(f,l,"Area A – High Priority")
}).addTo(map);

/* ===== AREA B ===== */
var areaBLayer = L.geoJSON(areaB,{
  style:{
    color:"#b8860b",
    weight:1,
    fillColor:"#ffff00",
    fillOpacity:0.35
  },
  onEachFeature:(f,l)=>popupAttributes(f,l,"Area B – Medium Priority")
}).addTo(map);

/* ===== AREA C ===== */
var areaCLayer = L.geoJSON(areaC,{
  style:{
    color:"#8b0000",
    weight:1,
    fillColor:"#ff0000",
    fillOpacity:0.35
  },
  onEachFeature:(f,l)=>popupAttributes(f,l,"Area C – Not Allowed")
}).addTo(map);

/* =========================
   LAYER CONTROL
========================= */
L.control.layers(null,{
  "Ramallah Boundary":ramallahLayer,
  "Area A (Allowed – High Priority)":areaALayer,
  "Area B (Allowed – Medium Priority)":areaBLayer,
  "Area C (Not Allowed)":areaCLayer
},{collapsed:false}).addTo(map);

}
</script>
</body>
</html>
