<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Web GIS - Ramallah</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html,body{height:100%;margin:0;}
#map{height:100%;width:100%;}

/* =========================
   BIG SVG ICONS
========================= */
.icon {
  width: 30px;
  height: 30px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:20px;
  font-weight:bold;
  border:2px solid #000;
}

/* Hospitals */
.icon-hospital {
  background:#b22222;
  color:#fff;
  border-radius:50%;
}

/* Clinics */
.icon-clinic {
  background:#2e8b57;
  color:#fff;
}

/* Schools */
.icon-school {
  background:#1e90ff;
  color:#fff;
  border-radius:6px;
}

/* Wells */
.icon-well {
  background:#00ced1;
  color:#000;
  transform: rotate(0deg);
  border-radius:50%;
}

/* Quarries */
.icon-quarry {
  background:#696969;
  color:#fff;
}

/* Outposts */
.icon-outpost {
  background:#ff8c00;
  color:#000;
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
}
</style>
</head>

<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
var map = L.map("map").setView([31.9038,35.2034],11);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{
  attribution:"&copy; OpenStreetMap"
}).addTo(map);

function popupAttributes(f,l){
  let h="";
  for(let k in f.properties){
    h+=`<b>${k}</b>: ${f.properties[k]}<br>`;
  }
  l.bindPopup(h);
}

function icon(html,cls){
  return L.divIcon({
    className:"",
    html:`<div class="icon ${cls}">${html}</div>`,
    iconSize:[30,30],
    iconAnchor:[15,15]
  });
}

Promise.all([
  fetch("ramallah.json").then(r=>r.json()),
  fetch("schools.json").then(r=>r.json()),
  fetch("roods.json").then(r=>r.json()),
  fetch("Built_up.json").then(r=>r.json()),
  fetch("Settlements.geojson").then(r=>r.json()),
  fetch("Outposts.geojson").then(r=>r.json()),
  fetch("Military sites.geojson").then(r=>r.json()),
  fetch("Quarries.geojson").then(r=>r.json()),
  fetch("natural.json").then(r=>r.json()),
  fetch("Wells.geojson").then(r=>r.json()),
  fetch("Clinics.geojson").then(r=>r.json()),
  fetch("Hospitals.geojson").then(r=>r.json())
]).then(initLayers);

function initLayers(d){

let [
  ramallah,schools,roads,built,
  settlements,outposts,military,
  quarries,natural,wells,clinics,hospitals
]=d;

/* boundaries */
var ramallahLayer=L.geoJSON(ramallah,{
  style:{color:"#000",weight:6,fillOpacity:0}
}).addTo(map);

var builtLayer=L.geoJSON(built,{
  style:{color:"#8B4513",weight:2,fillColor:"#F5F5DC",fillOpacity:0.7}
}).addTo(map);

var roadsLayer=L.geoJSON(roads,{
  style:{color:"#4B0082",weight:2}
}).addTo(map);

/* point layers */
var schoolsLayer=L.geoJSON(schools,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("ðŸŽ“","icon-school")}),
  onEachFeature:popupAttributes
}).addTo(map);

var wellsLayer=L.geoJSON(wells,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("ðŸ’§","icon-well")}),
  onEachFeature:popupAttributes
}).addTo(map);

var clinicsLayer=L.geoJSON(clinics,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("âœš","icon-clinic")}),
  onEachFeature:popupAttributes
}).addTo(map);

var hospitalsLayer=L.geoJSON(hospitals,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("âœš","icon-hospital")}),
  onEachFeature:popupAttributes
}).addTo(map);

var quarriesLayer=L.geoJSON(quarries,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("â›","icon-quarry")}),
  onEachFeature:popupAttributes
}).addTo(map);

var outpostsLayer=L.geoJSON(outposts,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("â›º","icon-outpost")}),
  onEachFeature:popupAttributes
}).addTo(map);

/* others */
var settlementsLayer=L.geoJSON(settlements,{
  style:{color:"#ff0000",weight:2}
}).addTo(map);

var militaryLayer=L.geoJSON(military,{
  style:{color:"#800000",weight:2}
}).addTo(map);

var naturalLayer=L.geoJSON(natural,{
  style:{color:"#228b22",fillOpacity:0.5}
}).addTo(map);

ramallahLayer.bringToFront();

L.control.layers(null,{
  "Ramallah Boundary":ramallahLayer,
  "Built-up Areas":builtLayer,
  "Roads":roadsLayer,
  "Schools":schoolsLayer,
  "Wells":wellsLayer,
  "Clinics":clinicsLayer,
  "Hospitals":hospitalsLayer,
  "Quarries":quarriesLayer,
  "Outposts":outpostsLayer,
  "Settlements":settlementsLayer,
  "Military Sites":militaryLayer,
  "Natural Areas":naturalLayer
},{collapsed:false}).addTo(map);
}
</script>
</body>
</html>
