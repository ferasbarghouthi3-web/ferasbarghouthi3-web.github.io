<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Web GIS - Ramallah</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html,body{height:100%;margin:0;}
#map{height:100%;width:100%;}

/* =========================
   ICONS
========================= */
.icon{
  width:20px;
  height:20px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:14px;
  font-weight:bold;
  border:2px solid #000;
}

.icon-school{background:#1e90ff;color:#fff;border-radius:4px;}
.icon-hospital{background:#b22222;color:#fff;border-radius:50%;}
.icon-clinic{background:#2e8b57;color:#fff;}
.icon-well{background:#00ced1;color:#000;border-radius:50%;}
.icon-quarry{background:#696969;color:#fff;}
.icon-outpost{
  background:#ff8c00;
  color:#000;
  clip-path:polygon(50% 0%,0% 100%,100% 100%);
}

/* =========================
   LEGEND
========================= */
.legend{
  background:white;
  padding:10px;
  font-size:13px;
  border-radius:6px;
  box-shadow:0 0 10px rgba(0,0,0,0.3);
}
.legend-item{
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:4px;
}

/* =========================
   POPUP STYLE
========================= */
.popup-table{
  border-collapse:collapse;
  width:100%;
}
.popup-table td{
  border-bottom:1px solid #ddd;
  padding:4px;
  font-size:12px;
}
.popup-title{
  font-weight:bold;
  margin-bottom:6px;
  color:#333;
}
</style>
</head>

<body>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* =========================
   MAP
========================= */
var map = L.map("map").setView([31.9038,35.2034],11);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{
  attribution:"&copy; OpenStreetMap"
}).addTo(map);

/* =========================
   POPUP FUNCTION (ALL LAYERS)
========================= */
function popupAttributes(feature, layer){
  if(!feature.properties) return;

  let html = '<div class="popup-title">Attributes</div>';
  html += '<table class="popup-table">';

  for(let key in feature.properties){
    html += `<tr><td><b>${key}</b></td><td>${feature.properties[key]}</td></tr>`;
  }

  html += '</table>';
  layer.bindPopup(html);
}

/* =========================
   DIV ICON
========================= */
function icon(symbol, cls){
  return L.divIcon({
    className:"",
    html:`<div class="icon ${cls}">${symbol}</div>`,
    iconSize:[20,20],
    iconAnchor:[10,10]
  });
}

/* =========================
   LOAD DATA
========================= */
Promise.all([
  fetch("ramallah.json").then(r=>r.json()),
  fetch("schools.json").then(r=>r.json()),
  fetch("roods.json").then(r=>r.json()),
  fetch("Built_up.json").then(r=>r.json()),
  fetch("Settlements.geojson").then(r=>r.json()),
  fetch("Outposts.geojson").then(r=>r.json()),
  fetch("Military sites.geojson").then(r=>r.json()),
  fetch("Quarries.geojson").then(r=>r.json()),
  fetch("natural.json").then(r=>r.json()),
  fetch("Wells.geojson").then(r=>r.json()),
  fetch("Clinics.geojson").then(r=>r.json()),
  fetch("Hospitals.geojson").then(r=>r.json())
]).then(initLayers);

/* =========================
   LAYERS
========================= */
function initLayers(data){

let [
  ramallah,schools,roads,built,
  settlements,outposts,military,
  quarries,natural,wells,clinics,hospitals
] = data;

/* Ramallah Boundary */
var ramallahLayer = L.geoJSON(ramallah,{
  style:{color:"#000",weight:4,fillOpacity:0},
  onEachFeature:popupAttributes
}).addTo(map);

/* Built-up */
var builtLayer = L.geoJSON(built,{
  style:{color:"#8B4513",weight:2,fillColor:"#F5F5DC",fillOpacity:0.7},
  onEachFeature:popupAttributes
}).addTo(map);

/* Roads */
var roadsLayer = L.geoJSON(roads,{
  style:{color:"#4B0082",weight:2},
  onEachFeature:popupAttributes
}).addTo(map);

/* Schools */
var schoolsLayer = L.geoJSON(schools,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("üéì","icon-school")}),
  onEachFeature:popupAttributes
}).addTo(map);

/* Wells */
var wellsLayer = L.geoJSON(wells,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("üíß","icon-well")}),
  onEachFeature:popupAttributes
}).addTo(map);

/* Clinics */
var clinicsLayer = L.geoJSON(clinics,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("‚úö","icon-clinic")}),
  onEachFeature:popupAttributes
}).addTo(map);

/* Hospitals */
var hospitalsLayer = L.geoJSON(hospitals,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("‚úö","icon-hospital")}),
  onEachFeature:popupAttributes
}).addTo(map);

/* Quarries */
var quarriesLayer = L.geoJSON(quarries,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("‚õè","icon-quarry")}),
  onEachFeature:popupAttributes
}).addTo(map);

/* Outposts */
var outpostsLayer = L.geoJSON(outposts,{
  pointToLayer:(f,ll)=>L.marker(ll,{icon:icon("‚õ∫","icon-outpost")}),
  onEachFeature:popupAttributes
}).addTo(map);

/* Settlements */
var settlementsLayer = L.geoJSON(settlements,{
  style:{color:"#ff0000",weight:2},
  onEachFeature:popupAttributes
}).addTo(map);

/* Military */
var militaryLayer = L.geoJSON(military,{
  style:{color:"#800000",weight:2},
  onEachFeature:popupAttributes
}).addTo(map);

/* Natural */
var naturalLayer = L.geoJSON(natural,{
  style:{color:"#228b22",fillOpacity:0.5},
  onEachFeature:popupAttributes
}).addTo(map);

/* =========================
   LEGEND
========================= */
var legend = L.control({position:"bottomright"});
legend.onAdd = function(){
  var div = L.DomUtil.create("div","legend");
  div.innerHTML = `
    <b>Legend</b>
    <div class="legend-item"><div class="icon icon-school">üéì</div> Schools</div>
    <div class="legend-item"><div class="icon icon-hospital">‚úö</div> Hospitals</div>
    <div class="legend-item"><div class="icon icon-clinic">‚úö</div> Clinics</div>
    <div class="legend-item"><div class="icon icon-well">üíß</div> Wells</div>
    <div class="legend-item"><div class="icon icon-quarry">‚õè</div> Quarries</div>
    <div class="legend-item"><div class="icon icon-outpost">‚õ∫</div> Outposts</div>
  `;
  return div;
};
legend.addTo(map);

/* Layer Control */
L.control.layers(null,{
  "Ramallah Boundary":ramallahLayer,
  "Built-up Areas":builtLayer,
  "Roads":roadsLayer,
  "Schools":schoolsLayer,
  "Hospitals":hospitalsLayer,
  "Clinics":clinicsLayer,
  "Wells":wellsLayer,
  "Quarries":quarriesLayer,
  "Outposts":outpostsLayer,
  "Settlements":settlementsLayer,
  "Military Sites":militaryLayer,
  "Natural Areas":naturalLayer
},{collapsed:false}).addTo(map);
}
</script>
</body>
</html>
